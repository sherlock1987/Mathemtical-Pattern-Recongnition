
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{HW34}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from} \PY{n+nn}{pandas} \PY{k}{import} \PY{n}{DataFrame}\PY{p}{,} \PY{n}{Series}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{from} \PY{n+nn}{seaborn} \PY{k}{import} \PY{n}{scatterplot}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{neighbors}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{datasets}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{import} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{as} \PY{n+nn}{metr}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}
        \PY{k+kn}{import} \PY{n+nn}{math}
        \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{c+c1}{\PYZsh{} import statsmodels.api as sm}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{RFE}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{RFE}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{RFECV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}
        \PY{k+kn}{from} \PY{n+nn}{numpy} \PY{k}{import} \PY{n}{linalg} \PY{k}{as} \PY{n}{la}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{StratifiedKFold}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{RFECV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{chi2}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegressionCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,} \PY{n}{auc}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{naive\PYZus{}bayes} \PY{k}{import} \PY{n}{GaussianNB}\PY{p}{,} \PY{n}{MultinomialNB}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{normalize}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{label\PYZus{}binarize}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{Users}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{HP}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{Desktop}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{EE559}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{HW34}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{AReM}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}samples}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
            \PY{n}{filename\PYZus{}whole} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{filename} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.pdf}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{filename}\PY{p}{)} \PY{o}{==} \PY{k+kc}{False}\PY{p}{:}
                    \PY{n}{filename\PYZus{}whole}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
            \PY{n}{filename\PYZus{}whole}\PY{o}{.}\PY{n}{sort}
            \PY{n}{test} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{train} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{filename\PYZus{}whole}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{n}{path\PYZus{}1} \PY{o}{=} \PY{n}{path} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{filename\PYZus{}whole}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{1}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} print(path\PYZus{}1)}
                    \PY{n}{filename1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                    \PY{k}{for} \PY{n}{filename} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{path\PYZus{}1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{filename1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
                    \PY{n}{filename1}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
                    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{filename1}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                        \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                        \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                        \PY{n}{test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
                    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{filename1}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{k}{if} \PY{p}{(}\PY{p}{(}\PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{j} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)} \PY{o}{==} \PY{k+kc}{True}\PY{p}{:}
                            \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{filename1}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                            \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                            \PY{n}{a} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 7}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                            \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                            \PY{n}{train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                            \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                            \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
                        \PY{k}{else}\PY{p}{:}
                            \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{filename1}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                            \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                            \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                            \PY{n}{train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                            \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                            \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
                \PY{k}{else}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} print(path\PYZus{}1)}
                    \PY{n}{filename1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                    \PY{k}{for} \PY{n}{filename} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{path\PYZus{}1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{filename1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
                    \PY{n}{filename1}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
                    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataset}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{j} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}
                        \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
        
                        \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                        \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                        \PY{n}{test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
        
                    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{filename1}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataset}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{j} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}
                        \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{error\PYZus{}bad\PYZus{}lines}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
                        \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                        \PY{n}{train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
        
            \PY{c+c1}{\PYZsh{} print(len(test))}
            \PY{c+c1}{\PYZsh{} print(len(train))}
            \PY{c+c1}{\PYZsh{} print(len(data))}
            \PY{k}{return} \PY{n}{test}\PY{p}{,} \PY{n}{train}\PY{p}{,} \PY{n}{data}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}samples\PYZus{}multi}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
            \PY{n}{filename\PYZus{}whole} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{filename} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.pdf}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{filename}\PY{p}{)} \PY{o}{==} \PY{k+kc}{False}\PY{p}{:}
                    \PY{n}{filename\PYZus{}whole}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
            \PY{n}{filename\PYZus{}whole}\PY{o}{.}\PY{n}{sort}
            \PY{n}{test} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{train} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{test\PYZus{}classes} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{train\PYZus{}classes} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{filename\PYZus{}whole}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{n}{path\PYZus{}1} \PY{o}{=} \PY{n}{path} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{filename\PYZus{}whole}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{1}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} print(path\PYZus{}1)}
                    \PY{n}{filename1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                    \PY{k}{for} \PY{n}{filename} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{path\PYZus{}1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{filename1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
                    \PY{n}{filename1}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
                    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{filename1}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                        \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                        \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                        \PY{n}{test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
                        \PY{n}{test\PYZus{}classes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename\PYZus{}whole}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{filename1}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{k}{if} \PY{p}{(}\PY{p}{(}\PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{j} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)} \PY{o}{==} \PY{k+kc}{True}\PY{p}{:}
                            \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{filename1}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                            \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                            \PY{n}{a} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 7}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                            \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                            \PY{n}{train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                            \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                            \PY{n}{train\PYZus{}classes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename\PYZus{}whole}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                            \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
                        \PY{k}{else}\PY{p}{:}
                            \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{filename1}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                            \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                            \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                            \PY{n}{train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                            \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                            \PY{n}{train\PYZus{}classes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename\PYZus{}whole}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                            \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
                \PY{k}{else}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} print(path\PYZus{}1)}
                    \PY{n}{filename1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                    \PY{k}{for} \PY{n}{filename} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{path\PYZus{}1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{filename1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
                    \PY{n}{filename1}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
                    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataset}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{j} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}
                        \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
        
                        \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                        \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                        \PY{n}{test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{n}{test\PYZus{}classes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename\PYZus{}whole}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        
                    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{filename1}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{n}{path1\PYZus{}1} \PY{o}{=} \PY{n}{path\PYZus{}1} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataset}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{j} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}
                        \PY{n}{a} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path1\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{skiprows}\PY{o}{=}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{error\PYZus{}bad\PYZus{}lines}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
                        \PY{n}{b} \PY{o}{=} \PY{n}{a}\PY{o}{.}\PY{n}{values}
                        \PY{n}{train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{b}\PY{p}{)}
                        \PY{n}{train\PYZus{}classes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{filename\PYZus{}whole}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                        \PY{c+c1}{\PYZsh{} print(path1\PYZus{}1)}
            \PY{k}{return} \PY{n}{test}\PY{p}{,} \PY{n}{train}\PY{p}{,} \PY{n}{data}\PY{p}{,} \PY{n}{train\PYZus{}classes}\PY{p}{,} \PY{n}{test\PYZus{}classes}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{k}{def} \PY{n+nf}{c\PYZus{}1}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{There are a lot of features used in time series}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{like correlation structure, distribution，entropy，stationarity，scaling properties}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{c\PYZus{}1}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
There are a lot of features used in time series
like correlation structure, distribution，entropy，stationarity，scaling properties

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k}{def} \PY{n+nf}{feature\PYZus{}extraction}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{n}{aa} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{:}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{:}
                     \PY{k}{if} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                         \PY{n}{aa}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                         \PY{n}{aa}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{:}
                         \PY{n}{aa}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{4}\PY{p}{:}
                         \PY{n}{aa}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{median\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{5}\PY{p}{:}
                         \PY{n}{aa}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{standard deviation\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{6}\PY{p}{:}
                         \PY{n}{aa}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1st quart\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{7}\PY{p}{:}
                         \PY{n}{aa}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3rd quart\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                     \PY{k}{else}\PY{p}{:}
                         \PY{k}{pass}
         
             \PY{n}{result} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{aa}\PY{p}{)}
             \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{88}\PY{p}{)}\PY{p}{:}
                 \PY{n}{bb} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{:}
                     \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                             \PY{n}{bb}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                         \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                             \PY{n}{bb}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                         \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                             \PY{n}{bb}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                         \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{:}
                             \PY{n}{bb}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                         \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{4}\PY{p}{:}
                             \PY{n}{bb}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                         \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{5}\PY{p}{:}
                             \PY{n}{bb}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}
                         \PY{k}{elif} \PY{n}{j} \PY{o}{==} \PY{l+m+mi}{6}\PY{p}{:}
                             \PY{n}{bb}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{75}\PY{p}{)}\PY{p}{)}
                         \PY{k}{else}\PY{p}{:}
                             \PY{k}{pass}
                 \PY{n}{result}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n}{bb}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{result}\PY{p}{)}
         \PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{whole\PYZus{}data} \PY{o}{=} \PY{n}{create\PYZus{}samples}\PY{p}{(}\PY{n}{path}\PY{p}{)}
         \PY{n}{feature\PYZus{}extraction}\PY{p}{(}\PY{n}{whole\PYZus{}data}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
    min\_1  max\_1     mean\_1  median\_1  standard deviation\_1  1st quart\_1  \textbackslash{}
0   37.25  45.00  40.624792    40.500              1.475428      39.2500   
1   38.00  45.67  42.812812    42.500              1.434054      42.0000   
2   35.00  47.40  43.954500    44.330              1.557210      43.0000   
3   33.00  47.75  42.179812    43.500              3.666840      39.1500   
4   33.00  45.75  41.678063    41.750              2.241152      41.3300   
5   37.00  48.00  43.454958    43.250              1.384653      42.5000   
6   36.25  48.00  43.969125    44.500              1.616677      43.3100   
7   12.75  51.00  24.562958    24.250              3.733619      23.1875   
8    0.00  42.75  27.464604    28.000              3.579847      25.5000   
9   21.00  50.00  32.586208    33.000              6.231642      26.1875   
10  27.50  33.00  29.876472    30.000              1.147607      29.0000   
11  19.00  45.50  30.938104    29.000              7.676137      26.7500   
12  25.00  47.50  31.058250    29.710              4.824761      27.5000   
13  24.25  45.00  37.177042    36.250              3.577569      34.5000   
14  28.75  44.75  37.561187    36.875              3.223144      35.2500   
15  22.00  44.67  37.058708    36.000              3.706313      34.5000   
16  19.00  44.00  36.228396    36.000              3.524939      34.0000   
17  26.50  44.33  36.687292    36.000              3.525726      34.2500   
18  25.33  45.00  37.114313    36.250              3.706518      34.5000   
19  26.75  44.75  36.863375    36.330              3.552081      34.5000   
20  26.25  44.25  36.957458    36.290              3.431283      34.5000   
21  27.75  44.67  37.144833    36.330              3.754986      34.0000   
22  27.00  45.00  36.819521    36.000              3.896394      33.7500   
23  27.00  44.33  36.541667    36.000              4.014734      33.2500   
24  18.50  44.25  35.752354    36.000              4.609992      33.0000   
25  19.00  43.75  35.879875    36.000              4.610068      33.0000   
26  23.33  43.50  36.244083    36.750              3.818032      33.4575   
27  24.25  45.00  37.177042    36.250              3.577569      34.5000   
28  23.50  30.00  27.716375    27.500              1.440750      27.0000   
29  24.75  48.33  44.182937    48.000              7.487803      48.0000   
..    {\ldots}    {\ldots}        {\ldots}       {\ldots}                   {\ldots}          {\ldots}   
58  33.33  48.00  44.334729    45.000              2.474358      42.2500   
59  35.50  46.25  43.174938    43.670              1.986979      42.5000   
60  32.75  47.00  42.760562    44.500              3.395376      41.3300   
61  30.00  46.67  42.648521    42.750              2.392842      41.5000   
62  36.00  47.50  43.720021    45.000              2.381620      43.0000   
63  34.50  47.75  44.471146    45.000              1.770706      45.0000   
64  35.50  48.00  46.224938    46.000              1.746493      45.2500   
65  29.75  48.00  46.932208    47.500              1.830755      47.2375   
66  36.33  47.67  45.399625    45.500              1.326737      45.0000   
67  36.00  45.80  42.419917    42.670              2.517503      41.3300   
68  37.00  48.25  42.516958    42.500              2.193462      41.0000   
69  36.25  45.50  42.959354    42.670              1.499314      42.0000   
70  36.00  47.33  42.674583    43.670              2.381685      40.0000   
71  36.25  45.75  43.187521    44.750              2.488565      39.7500   
72  36.00  47.33  44.441187    45.000              2.415277      44.6275   
73  19.33  43.50  34.227771    35.500              4.884480      30.5000   
74  12.50  45.00  33.509729    34.125              4.845868      30.5000   
75  15.00  46.75  34.660583    35.000              5.309571      31.0000   
76  18.00  46.00  35.193333    36.000              4.746916      32.0000   
77  20.75  46.25  34.763333    35.290              4.737266      31.6700   
78  21.50  51.00  34.935812    35.500              4.641102      32.0000   
79  18.33  47.67  34.333042    34.750              4.943612      31.2500   
80  18.33  45.75  34.599875    35.125              4.726858      31.5000   
81  15.50  43.67  34.225875    34.750              4.437168      31.2500   
82  21.50  51.25  34.253521    35.000              4.935592      30.9375   
83  19.50  45.33  33.586875    34.250              4.646088      30.2500   
84  19.75  45.50  34.322750    35.250              4.747524      31.0000   
85  19.50  46.00  34.546229    35.250              4.837247      31.2500   
86  23.50  46.25  34.873229    35.250              4.526997      31.7500   
87  19.25  44.00  34.473188    35.000              4.791706      31.2500   

    3rd quart\_1  min\_2  max\_2    mean\_2     {\ldots}       standard deviation\_5  \textbackslash{}
0       42.0000    0.0   1.30  0.358604     {\ldots}                   2.186168   
1       43.6700    0.0   1.22  0.372437     {\ldots}                   1.993175   
2       45.0000    0.0   1.70  0.426250     {\ldots}                   1.997520   
3       45.0000    0.0   3.00  0.696042     {\ldots}                   3.845436   
4       42.7500    0.0   2.83  0.535979     {\ldots}                   2.408514   
5       45.0000    0.0   1.58  0.378083     {\ldots}                   2.486268   
6       44.6700    0.0   1.50  0.413125     {\ldots}                   3.314843   
7       26.5000    0.0   6.87  0.590833     {\ldots}                   3.689936   
8       30.0000    0.0   7.76  0.449708     {\ldots}                   5.048375   
9       34.5000    0.0   9.90  0.516125     {\ldots}                   5.027179   
10      30.2500    0.0   1.00  0.255929     {\ldots}                   1.745504   
11      38.0000    0.0   6.40  0.467167     {\ldots}                   5.839819   
12      31.8125    0.0   6.38  0.405458     {\ldots}                   7.845242   
13      40.2500    0.0   8.58  2.374208     {\ldots}                   2.887335   
14      40.2500    0.0   9.91  2.080687     {\ldots}                   2.724534   
15      40.0625    0.0  14.17  2.438146     {\ldots}                   3.533457   
16      39.0000    0.0  12.28  2.831687     {\ldots}                   3.163354   
17      39.3725    0.0  12.89  2.973042     {\ldots}                   2.975134   
18      40.2500    0.0  10.84  2.730000     {\ldots}                   2.844908   
19      39.7500    0.0  11.68  2.757312     {\ldots}                   2.653138   
20      40.2500    0.0   8.64  2.420083     {\ldots}                   2.848701   
21      40.5000    0.0  10.76  2.419062     {\ldots}                   2.686488   
22      40.2500    0.0  10.47  2.600146     {\ldots}                   2.778132   
23      39.8125    0.0  10.43  2.847958     {\ldots}                   3.084922   
24      39.3300    0.0  12.60  3.328104     {\ldots}                   3.116805   
25      39.5000    0.0  11.20  3.414312     {\ldots}                   3.533948   
26      39.2500    0.0   9.71  2.736021     {\ldots}                   3.613931   
27      40.2500    0.0   8.58  2.374208     {\ldots}                   2.887335   
28      29.0000    0.0   1.79  0.363687     {\ldots}                   4.070265   
29      48.0000    0.0   3.11  0.101875     {\ldots}                   3.271126   
..          {\ldots}    {\ldots}    {\ldots}       {\ldots}     {\ldots}                        {\ldots}   
58      46.5000    0.0   3.90  0.432958     {\ldots}                   5.396165   
59      44.5000    0.0   2.12  0.506583     {\ldots}                   2.980866   
60      45.3725    0.0   3.34  0.486167     {\ldots}                   4.292096   
61      45.0000    0.0   2.95  0.402833     {\ldots}                   3.138405   
62      45.0000    0.0   1.92  0.366708     {\ldots}                   3.285710   
63      45.2500    0.0   2.18  0.290479     {\ldots}                   2.609667   
64      48.0000    0.0   4.50  0.312354     {\ldots}                   2.928525   
65      47.7500    0.0   4.60  0.429667     {\ldots}                   3.131555   
66      46.3300    0.0   1.66  0.460146     {\ldots}                   3.370579   
67      44.6175    0.0   2.12  0.460562     {\ldots}                   3.718195   
68      44.5000    0.0   2.12  0.440687     {\ldots}                   3.619780   
69      44.3300    0.0   2.60  0.352875     {\ldots}                   2.699788   
70      44.7500    0.0   2.17  0.419167     {\ldots}                   3.258218   
71      45.0000    0.0   2.83  0.271271     {\ldots}                   3.562322   
72      45.7500    0.0   4.50  0.346604     {\ldots}                   3.410896   
73      37.7500    0.0  14.50  3.995729     {\ldots}                   3.088871   
74      36.7500    0.0  13.05  4.450771     {\ldots}                   3.130299   
75      38.2500    0.0  13.44  4.200896     {\ldots}                   3.151727   
76      38.7500    0.0  16.20  4.321021     {\ldots}                   3.204299   
77      38.2500    0.0  12.68  4.223792     {\ldots}                   3.171372   
78      38.0625    0.0  12.21  4.115750     {\ldots}                   3.188731   
79      38.0000    0.0  12.48  4.396958     {\ldots}                   2.997366   
80      38.0000    0.0  15.37  4.398833     {\ldots}                   2.902659   
81      37.2500    0.0  17.24  4.354500     {\ldots}                   2.989801   
82      37.7500    0.0  13.55  4.457896     {\ldots}                   3.113379   
83      37.0000    0.0  14.67  4.576562     {\ldots}                   3.280561   
84      38.0000    0.0  13.47  4.456333     {\ldots}                   3.116605   
85      37.8125    0.0  12.47  4.371958     {\ldots}                   2.820182   
86      38.2500    0.0  14.82  4.380583     {\ldots}                   3.127813   
87      38.0000    0.0  13.86  4.359312     {\ldots}                   3.153030   

    1st quart\_5  3rd quart\_5  min\_6  max\_6    mean\_6  median\_6  \textbackslash{}
0       33.0000      36.0000   0.00   1.92  0.570583     0.430   
1       32.0000      34.5000   0.00   3.11  0.571083     0.430   
2       35.3625      36.5000   0.00   1.79  0.493292     0.430   
3       30.4575      36.3300   0.00   2.18  0.613521     0.500   
4       28.4575      31.2500   0.00   1.79  0.383292     0.430   
5       22.2500      24.0000   0.00   5.26  0.679646     0.500   
6       20.5000      23.7500   0.00   2.96  0.555312     0.490   
7       20.5000      27.0000   0.00   4.97  0.700188     0.500   
8       15.0000      20.7500   0.00   6.76  1.122125     0.830   
9       17.6700      23.5000   0.00  13.61  1.162042     0.830   
10      17.0000      19.0000   0.00   6.40  0.701002     0.710   
11      15.0000      20.8125   0.00   6.73  1.107354     0.830   
12       9.0000      18.3125   0.00   4.92  1.098104     0.940   
13      17.9500      21.7500   0.00   9.34  2.921729     2.500   
14      18.0000      21.5000   0.00   9.62  2.765896     2.450   
15      16.0000      21.0000   0.00   8.55  2.983750     2.570   
16      14.0000      18.0625   0.00   9.98  3.480688     3.340   
17      14.6700      18.5000   0.00   8.19  3.073313     2.690   
18      14.7500      18.5000   0.00   9.50  3.076354     2.770   
19      15.0000      18.6700   0.00   8.81  2.773313     2.590   
20      14.0000      18.2500   0.00   8.34  2.934625     2.525   
21      15.0000      18.7500   0.00   8.75  2.822437     2.590   
22      15.5000      19.2700   0.00   8.99  2.887563     2.525   
23      15.0000      19.5000   0.00   9.18  3.225458     2.870   
24      14.0000      18.0625   0.00   9.39  3.069667     2.770   
25      14.7500      19.6900   0.00   8.50  3.093021     2.930   
26      15.7500      21.0000   0.00  11.15  3.530500     3.110   
27      17.9500      21.7500   0.00   9.34  2.921729     2.500   
28       5.5000      10.7500   0.00   4.50  0.734271     0.710   
29       2.0000       5.5425   0.00   3.91  0.692771     0.500   
..          {\ldots}          {\ldots}    {\ldots}    {\ldots}       {\ldots}       {\ldots}   
58       9.3300      17.7500   0.00   5.02  0.933000     0.830   
59      12.7500      16.5000   0.00   5.72  0.911979     0.830   
60      13.0000      18.5650   0.00   5.73  0.842271     0.710   
61      10.6275      14.2500   0.00   4.64  0.917354     0.830   
62      11.3100      15.5425   0.00   6.18  1.039687     0.830   
63      12.0000      14.8125   0.00   4.32  0.927375     0.830   
64      12.0000      15.2500   0.00   6.00  0.882583     0.830   
65      11.6700      15.5000   0.00   6.58  0.991125     0.830   
66      11.2500      14.5000   0.00   4.50  0.795104     0.820   
67       7.6275      12.0000   0.00   6.65  1.226271     1.090   
68      12.6275      17.5000   0.00   6.85  0.977417     0.830   
69      14.0000      16.6900   0.00   4.00  0.748479     0.820   
70      12.7500      16.5000   0.00   3.77  0.702042     0.500   
71      16.5000      21.0000   0.00   3.83  0.645458     0.500   
72      11.0000      14.6700   0.00   5.91  1.155083     0.940   
73      14.7500      18.6700   0.00   9.74  3.394125     3.100   
74      14.6275      18.7500   0.00   8.96  3.378479     3.085   
75      14.2500      18.5000   0.00   8.99  3.244396     3.000   
76      14.2500      18.5000   0.00   8.50  3.241958     3.015   
77      14.2500      18.3300   0.00   9.39  3.288271     3.270   
78      14.2375      18.2500   0.00  10.21  3.280021     3.015   
79      13.7500      18.0000   0.00   8.01  3.261583     2.980   
80      14.0000      18.2500   0.00   8.86  3.289542     3.015   
81      14.3300      18.2500   0.00   9.42  3.479542     3.270   
82      13.7500      18.0000   0.00   8.32  3.500750     3.285   
83      13.7300      18.2500   0.00   8.32  3.259729     3.110   
84      13.5000      17.7500   0.00   9.67  3.432563     3.200   
85      14.0000      17.7500   0.00  10.00  3.338125     3.080   
86      13.7500      18.0000   0.00   9.51  3.424646     3.270   
87      13.7300      17.7500   0.43   9.00  3.340458     3.090   

    standard deviation\_6  1st quart\_6  3rd quart\_6  
0               0.582308       0.0000       1.3000  
1               0.600383       0.0000       1.3000  
2               0.512971       0.0000       0.9400  
3               0.523771       0.0000       1.0000  
4               0.388759       0.0000       0.5000  
5               0.621885       0.4300       0.8700  
6               0.487318       0.0000       0.8300  
7               0.692997       0.4300       0.8700  
8               1.011287       0.4700       1.3000  
9               1.331591       0.4700       1.3000  
10              0.480909       0.4700       0.9400  
11              1.079715       0.4700       1.3000  
12              0.830614       0.5000       1.3000  
13              1.850669       1.5000       3.9000  
14              1.767359       1.4100       3.7700  
15              1.813837       1.5000       4.1500  
16              1.825864       2.1025       4.5500  
17              1.627976       1.9125       4.0875  
18              1.822633       1.7000       4.0375  
19              1.568283       1.6400       3.6325  
20              1.629680       1.6600       4.0300  
21              1.635476       1.5800       3.7400  
22              1.721298       1.5600       3.7700  
23              1.767913       1.8850       4.2625  
24              1.746503       1.7975       4.0600  
25              1.624339       1.8900       4.0600  
26              1.961639       2.1700       4.6175  
27              1.850669       1.5000       3.9000  
28              0.613049       0.4300       1.0000  
29              0.675076       0.3225       0.9400  
..                   {\ldots}          {\ldots}          {\ldots}  
58              0.672907       0.4700       1.2500  
59              0.665467       0.4700       1.2200  
60              0.721413       0.4300       1.0900  
61              0.708898       0.4700       1.1200  
62              0.915702       0.4700       1.2200  
63              0.755647       0.4700       1.2200  
64              0.667727       0.4700       1.1200  
65              0.854438       0.4700       1.2200  
66              0.502483       0.4700       1.0000  
67              0.891058       0.5000       1.5850  
68              0.852390       0.4700       1.2200  
69              0.460671       0.4300       0.9500  
70              0.566859       0.4300       0.9400  
71              0.566828       0.4300       0.8300  
72              0.841210       0.5000       1.5000  
73              1.790222       2.1050       4.4250  
74              1.785497       2.0600       4.4400  
75              1.629283       2.1200       4.2400  
76              1.767339       1.8850       4.4400  
77              1.645811       2.0500       4.3050  
78              1.699145       2.1200       4.5000  
79              1.615604       2.0500       4.3200  
80              1.678418       2.1200       4.2600  
81              1.759311       2.2400       4.5375  
82              1.690614       2.1800       4.5575  
83              1.638534       2.0500       4.3225  
84              1.730921       2.1575       4.5650  
85              1.655016       2.1600       4.3350  
86              1.689198       2.1700       4.5000  
87              1.697343       2.1200       4.3750  

[88 rows x 42 columns]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{def} \PY{n+nf}{d\PYZus{}1}\PY{p}{(}\PY{n}{train}\PY{p}{)}\PY{p}{:}
             \PY{n}{data\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{column\PYZus{}index} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{]}\PY{p}{:}
                 \PY{n}{mean\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n}{std\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n}{percentile\PYZus{}1st\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n}{class\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{:}
                     \PY{n}{mean} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                     \PY{n}{std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                     \PY{n}{percentile\PYZus{}1st} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{)}
                     \PY{n}{mean\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{)}
                     \PY{n}{std\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{std}\PY{p}{)}
                     \PY{n}{percentile\PYZus{}1st\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percentile\PYZus{}1st}\PY{p}{)}
                     \PY{n}{class\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{69}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                     \PY{n}{mean} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                     \PY{n}{std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                     \PY{n}{percentile\PYZus{}1st} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{)}
                     \PY{n}{mean\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{)}
                     \PY{n}{std\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{std}\PY{p}{)}
                     \PY{n}{percentile\PYZus{}1st\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percentile\PYZus{}1st}\PY{p}{)}
                     \PY{n}{class\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}1}\PY{p}{)}
                 \PY{n}{data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{std\PYZus{}1}\PY{p}{)}
                 \PY{n}{data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percentile\PYZus{}1st\PYZus{}1}\PY{p}{)}
                 \PY{n}{column\PYZus{}index}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n}{column\PYZus{}index}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n}{column\PYZus{}index}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}percentile\PYZus{}1st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{class\PYZus{}1}\PY{p}{)}
             \PY{n}{column\PYZus{}index}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{data\PYZus{}result} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{data\PYZus{}list}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{data\PYZus{}result}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
             \PY{n}{data\PYZus{}df} \PY{o}{=} \PY{n}{DataFrame}\PY{p}{(}\PY{n}{data\PYZus{}result}\PY{o}{.}\PY{n}{T}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{column\PYZus{}index}\PY{p}{)}
             \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{data\PYZus{}df}\PY{p}{,} \PY{n}{hue}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{n+nb}{vars}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1\PYZus{}percentile\PYZus{}1st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2\PYZus{}percentile\PYZus{}1st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{6\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{6\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{6\PYZus{}percentile\PYZus{}1st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{d\PYZus{}1}\PY{p}{(}\PY{n}{train\PYZus{}data}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(10, 69)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_6_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{k}{def} \PY{n+nf}{d\PYZus{}2\PYZus{}1}\PY{p}{(}\PY{n}{train}\PY{p}{)}\PY{p}{:}
             \PY{n}{piece} \PY{o}{=} \PY{l+m+mi}{240}
             \PY{n}{data\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{column\PYZus{}index} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{result} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{]}\PY{p}{:}
                 \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
                     \PY{n}{mean\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                     \PY{n}{std\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                     \PY{n}{percentile\PYZus{}1st\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                     \PY{n}{class\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
                     \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{69}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{j} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{9}\PY{p}{:}
                             \PY{n}{flag} \PY{o}{=} \PY{l+m+mi}{1}
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{flag} \PY{o}{=} \PY{l+m+mi}{0}
                         \PY{k}{if} \PY{p}{(}\PY{p}{(}\PY{p}{(}\PY{n}{i} \PY{o}{==} \PY{l+m+mi}{6}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{k} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{o}{==} \PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
                             \PY{n}{mean} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                             \PY{n}{std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                             \PY{n}{percentile\PYZus{}1st} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{)}
                             \PY{n}{mean\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{)}
                             \PY{n}{std\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{std}\PY{p}{)}
                             \PY{n}{percentile\PYZus{}1st\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percentile\PYZus{}1st}\PY{p}{)}
                             \PY{n}{class\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{flag}\PY{p}{)}
                         \PY{k}{elif} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                             \PY{n}{mean} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                             \PY{n}{std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                             \PY{n}{percentile\PYZus{}1st} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{)}
                             \PY{n}{mean\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{)}
                             \PY{n}{std\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{std}\PY{p}{)}
                             \PY{n}{percentile\PYZus{}1st\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percentile\PYZus{}1st}\PY{p}{)}
                             \PY{n}{class\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{flag}\PY{p}{)}
                         \PY{k}{else}\PY{p}{:}
                             \PY{k}{pass}
                     \PY{k}{if} \PY{p}{(}\PY{p}{(}\PY{p}{(}\PY{n}{i} \PY{o}{==} \PY{l+m+mi}{6}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{k} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{o}{==} \PY{k+kc}{True}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                         \PY{n}{data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}1}\PY{p}{)}
                         \PY{n}{data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{std\PYZus{}1}\PY{p}{)}
                         \PY{n}{data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percentile\PYZus{}1st\PYZus{}1}\PY{p}{)}
                     \PY{k}{else}\PY{p}{:}
                         \PY{k}{pass}
         
             \PY{n}{data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{class\PYZus{}1}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{]}\PY{p}{:}
                 \PY{n}{column\PYZus{}index}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n}{column\PYZus{}index}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n}{column\PYZus{}index}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}percentile\PYZus{}1st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{column\PYZus{}index}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                 \PY{n}{result}\PY{p}{[}\PY{n}{column\PYZus{}index}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}
             \PY{n}{data\PYZus{}df} \PY{o}{=} \PY{n}{DataFrame}\PY{p}{(}\PY{n}{result}\PY{p}{)}
             \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{data\PYZus{}df}\PY{p}{,} \PY{n}{hue}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{n+nb}{vars}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1\PYZus{}percentile\PYZus{}1st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2\PYZus{}percentile\PYZus{}1st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{12\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{12\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{12\PYZus{}percentile\PYZus{}1st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{d\PYZus{}2\PYZus{}1}\PY{p}{(}\PY{n}{train\PYZus{}data}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    d\_2: Acutally, I think the second diagram shows more sparse data,
especially in the margin.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{k}{def} \PY{n+nf}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{train}\PY{p}{,} \PY{n}{num}\PY{p}{,} \PY{n}{sep}\PY{p}{)}\PY{p}{:}
             \PY{n}{piece} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{l+m+mi}{480} \PY{o}{/} \PY{n}{num}\PY{p}{)}
             \PY{n}{results} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
             \PY{k}{if} \PY{n}{sep} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{n}{sep\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{9}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{sep\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{4}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{]}\PY{p}{:}
                 \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num}\PY{p}{)}\PY{p}{:}
                     \PY{n}{mean\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                     \PY{n}{std\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                     \PY{n}{percentile\PYZus{}1st\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                     \PY{n}{class\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                     \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{train}\PY{p}{)}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{} 69 or...}
                         \PY{k}{if} \PY{n}{j} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{sep\PYZus{}1}\PY{p}{:}
                             \PY{n}{flag} \PY{o}{=} \PY{l+m+mi}{0}
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{flag} \PY{o}{=} \PY{l+m+mi}{1}
                         \PY{k}{if} \PY{n}{k} \PY{o}{==} \PY{p}{(}\PY{n}{num} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                             \PY{n}{num\PYZus{}1} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                             \PY{n}{mean} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{n}{num\PYZus{}1}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                             \PY{n}{std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{n}{num\PYZus{}1}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                             \PY{n}{percentile\PYZus{}1st} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{n}{num\PYZus{}1}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
         
                             \PY{c+c1}{\PYZsh{} percentile\PYZus{}1st = np.percentile(train[j][k * piece:num\PYZus{}1, i], 75)}
                             \PY{n}{mean\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{)}
                             \PY{n}{std\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{std}\PY{p}{)}
                             \PY{n}{percentile\PYZus{}1st\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percentile\PYZus{}1st}\PY{p}{)}
                             \PY{n}{class\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{flag}\PY{p}{)}
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{mean} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                             \PY{n}{std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                             \PY{n}{percentile\PYZus{}1st} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{[}\PY{n}{k} \PY{o}{*} \PY{n}{piece}\PY{p}{:}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{piece}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
         
                             \PY{c+c1}{\PYZsh{} percentile\PYZus{}1st = np.percentile(train[j][k * piece:(k + 1) * piece, i], 75)}
                             \PY{n}{mean\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{)}
                             \PY{n}{std\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{std}\PY{p}{)}
                             \PY{n}{percentile\PYZus{}1st\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{percentile\PYZus{}1st}\PY{p}{)}
                             \PY{n}{class\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{flag}\PY{p}{)}
                     \PY{n}{results}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{mean\PYZus{}1}
                     \PY{n}{results}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{std\PYZus{}1}
                     \PY{n}{results}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}percentile\PYZus{}3st}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{percentile\PYZus{}1st\PYZus{}1}
             \PY{n}{results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{class\PYZus{}1}
             \PY{k}{return} \PY{n}{results}
         
         
         \PY{k}{def} \PY{n+nf}{test\PYZus{}LogisticRegression}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
             \PY{n+nb+bp}{cls} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
             \PY{n}{results} \PY{o}{=} \PY{n+nb+bp}{cls}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
             \PY{n}{scores} \PY{o}{=} \PY{n+nb+bp}{cls}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
             \PY{k}{return} \PY{n}{scores}
         
         
         \PY{k}{def} \PY{n+nf}{features\PYZus{}backward\PYZus{}selection}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
             \PY{n}{selected\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{scores\PYZus{}result} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{estimator} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n}{delete\PYZus{}column\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n}{selector} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{estimator}\PY{p}{,} \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{n}{i}\PY{p}{)}
                 \PY{n}{selector} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
                 \PY{n}{delete\PYZus{}column} \PY{o}{=} \PY{p}{(}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{)}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{delete\PYZus{}column}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                     \PY{k}{if} \PY{n}{delete\PYZus{}column}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{==} \PY{k+kc}{True}\PY{p}{:}
                         \PY{n}{delete\PYZus{}column\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{j}\PY{p}{)}
                     \PY{k}{else}\PY{p}{:}
                         \PY{k}{pass}
                 \PY{n}{x\PYZus{}train\PYZus{}new} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{delete\PYZus{}column\PYZus{}1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{x\PYZus{}test\PYZus{}new} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{delete\PYZus{}column\PYZus{}1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{sfolder} \PY{o}{=} \PY{n}{StratifiedKFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
                 \PY{k}{for} \PY{n}{train}\PY{p}{,} \PY{n}{test} \PY{o+ow}{in} \PY{n}{sfolder}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}new}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{} x\PYZus{}train, y\PYZus{}train, x\PYZus{}test, y\PYZus{}test}
                     \PY{n}{x\PYZus{}train\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}new}\PY{p}{,} \PY{n}{test}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                     \PY{n}{x\PYZus{}test\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}new}\PY{p}{,} \PY{n}{train}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                     \PY{n}{y\PYZus{}train\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{test}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                     \PY{n}{y\PYZus{}test\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{train}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                     \PY{n}{scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{test\PYZus{}LogisticRegression}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}1}\PY{p}{,} \PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}1}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}1}\PY{p}{)}\PY{p}{)}
                 \PY{n}{scores\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{scores}\PY{p}{)}\PY{p}{)}
                 \PY{n}{scores\PYZus{}result}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{scores\PYZus{}1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}     print(scores\PYZus{}result)}
             \PY{n}{bbb} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{scores\PYZus{}result}\PY{p}{)}\PY{p}{)}
             \PY{n}{aaa} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{scores\PYZus{}result}\PY{p}{)}\PY{p}{)}
             \PY{n}{result\PYZus{}1} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{bbb} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{result\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{aaa}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{number of features selected is}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{result\PYZus{}1}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{best score is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{result\PYZus{}2}\PY{p}{)}
             \PY{k}{return} \PY{n}{result\PYZus{}1}\PY{p}{,} \PY{n}{result\PYZus{}2}\PY{p}{,} \PY{n}{x\PYZus{}train\PYZus{}new}\PY{p}{,} \PY{n}{x\PYZus{}test\PYZus{}new}
         
         
         \PY{k}{def} \PY{n+nf}{find\PYZus{}best}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{accuracy} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{features} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{x\PYZus{}train\PYZus{}new\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{x\PYZus{}test\PYZus{}new\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{l} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{whole\PYZus{}data} \PY{o}{=} \PY{n}{create\PYZus{}samples}\PY{p}{(}\PY{n}{path}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                 \PY{n}{train} \PY{o}{=} \PY{n}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{i}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}
                 \PY{n}{train\PYZus{}2} \PY{o}{=} \PY{p}{(}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{values}
                 \PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{train\PYZus{}2}\PY{p}{,} \PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}2}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}
         
                 \PY{n}{test} \PY{o}{=} \PY{n}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{i}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{test\PYZus{}2} \PY{o}{=} \PY{p}{(}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{values}
                 \PY{n}{x\PYZus{}test} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{test\PYZus{}2}\PY{p}{,} \PY{n}{test\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test\PYZus{}2}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{test\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train shape is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         
                 \PY{n}{result\PYZus{}1}\PY{p}{,} \PY{n}{result\PYZus{}2}\PY{p}{,} \PY{n}{x\PYZus{}train\PYZus{}new}\PY{p}{,} \PY{n}{x\PYZus{}test\PYZus{}new} \PY{o}{=} \PY{n}{features\PYZus{}backward\PYZus{}selection}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
                 \PY{n}{accuracy}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{result\PYZus{}2}\PY{p}{)}
                 \PY{n}{features}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{result\PYZus{}1}\PY{p}{)}
                 \PY{n}{x\PYZus{}train\PYZus{}new\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}new}\PY{p}{)}
                 \PY{n}{x\PYZus{}test\PYZus{}new\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}new}\PY{p}{)}
             \PY{n}{accuracy\PYZus{}index} \PY{o}{=} \PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{accuracy}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n}{best} \PY{o}{=} \PY{p}{(}\PY{n}{l}\PY{p}{[}\PY{n}{accuracy\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{features}\PY{p}{[}\PY{n}{accuracy\PYZus{}index}\PY{p}{]}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{best}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The best test score is }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}
                 \PY{n}{test\PYZus{}LogisticRegression}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}new\PYZus{}1}\PY{p}{[}\PY{n}{accuracy\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{x\PYZus{}test\PYZus{}new\PYZus{}1}\PY{p}{[}\PY{n}{accuracy\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{the wrong way is that just assuming the number of predictors we should use, }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{and then use cross validation to select the best l in this case.}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{the right way is that using cross validation in both step 1 and 2, that is }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{using CV to find the best number of predicators, and then usc CV to find }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{the best number of l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{return} \PY{n}{l}\PY{p}{[}\PY{n}{accuracy\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{features}\PY{p}{[}\PY{n}{accuracy\PYZus{}index}\PY{p}{]}
         
         \PY{n}{l}\PY{p}{,}\PY{n}{num} \PY{o}{=} \PY{n}{find\PYZus{}best}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
train shape is  (69, 19)
number of features selected is 17
best score is  0.9285714285714286
train shape is  (69, 37)
number of features selected is 34
best score is  0.9571428571428571
train shape is  (69, 55)
number of features selected is 53
best score is  0.9417582417582417
train shape is  (69, 73)
number of features selected is 70
best score is  0.9714285714285715
train shape is  (69, 91)
number of features selected is 89
best score is  0.9714285714285715
train shape is  (69, 109)
number of features selected is 107
best score is  0.9428571428571428
train shape is  (69, 127)
number of features selected is 125
best score is  0.9714285714285715
train shape is  (69, 145)
number of features selected is 143
best score is  0.9571428571428571
train shape is  (69, 163)
number of features selected is 161
best score is  0.9571428571428571
train shape is  (69, 181)
number of features selected is 179
best score is  0.9571428571428571
train shape is  (69, 199)
number of features selected is 197
best score is  0.9571428571428571
train shape is  (69, 217)
number of features selected is 215
best score is  0.9571428571428571
train shape is  (69, 235)
number of features selected is 233
best score is  0.9571428571428571
train shape is  (69, 253)
number of features selected is 251
best score is  0.9571428571428571
train shape is  (69, 271)
number of features selected is 269
best score is  0.9571428571428571
train shape is  (69, 289)
number of features selected is 287
best score is  0.9571428571428571
train shape is  (69, 307)
number of features selected is 305
best score is  0.9571428571428571
train shape is  (69, 325)
number of features selected is 323
best score is  0.9571428571428571
train shape is  (69, 343)
number of features selected is 341
best score is  0.9571428571428571
train shape is  (69, 361)
number of features selected is 359
best score is  0.9571428571428571
(4, 70)
The best test score is 0.789474
the wrong way is that just assuming the number of predictors we should use, 
and then use cross validation to select the best l in this case.
the right way is that using cross validation in both step 1 and 2, that is 
using CV to find the best number of predicators, and then usc CV to find 
the best number of l

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{k}{def} \PY{n+nf}{dram\PYZus{}diagram}\PY{p}{(}\PY{n}{l}\PY{p}{)}\PY{p}{:}
             \PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{whole\PYZus{}data} \PY{o}{=} \PY{n}{create\PYZus{}samples}\PY{p}{(}\PY{n}{path}\PY{p}{)}
             \PY{n}{train} \PY{o}{=} \PY{n}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{l}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}
             \PY{n}{train\PYZus{}2} \PY{o}{=} \PY{p}{(}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{values}
             \PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{train\PYZus{}2}\PY{p}{,} \PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}2}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}
         
             \PY{n}{test} \PY{o}{=} \PY{n}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{l}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{test\PYZus{}2} \PY{o}{=} \PY{p}{(}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{values}
             \PY{n}{x\PYZus{}test} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{test\PYZus{}2}\PY{p}{,} \PY{n}{test\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test\PYZus{}2}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{test\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
             \PY{n}{result\PYZus{}1}\PY{p}{,} \PY{n}{result\PYZus{}2}\PY{p}{,} \PY{n}{x\PYZus{}train\PYZus{}new}\PY{p}{,} \PY{n}{x\PYZus{}test\PYZus{}new} \PY{o}{=} \PY{n}{features\PYZus{}backward\PYZus{}selection}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{result\PYZus{}1}\PY{p}{,} \PY{n}{result\PYZus{}2}\PY{p}{)}
         
             \PY{n}{classifier} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
             \PY{n}{classifier}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
             \PY{n}{predic\PYZus{}train} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}
             \PY{n}{predic\PYZus{}test} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{)}
             \PY{n}{vc\PYZus{}matrix1} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{predic\PYZus{}train}\PY{p}{)}
             \PY{n}{vc\PYZus{}matrix2} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{predic\PYZus{}test}\PY{p}{)}
         
             \PY{n}{predictions} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 每一类的概率.我的概率都是百分百了。。。auc也画不出来啊}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{predictions}\PY{p}{)}
             \PY{n}{false\PYZus{}positive\PYZus{}rate}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{predictions}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{roc\PYZus{}auc} \PY{o}{=} \PY{n}{auc}\PY{p}{(}\PY{n}{false\PYZus{}positive\PYZus{}rate}\PY{p}{,} \PY{n}{recall}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Receiver Operating Characteristic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{false\PYZus{}positive\PYZus{}rate}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AUC = }\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{roc\PYZus{}auc}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lower right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fpr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{scores}\PY{p}{,} \PY{n}{pvalues} \PY{o}{=} \PY{n}{chi2}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{confusion matrix for train}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{vc\PYZus{}matrix1}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{confusion matrix for test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{vc\PYZus{}matrix2}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coefficient is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{classifier}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{interception is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{classifier}\PY{o}{.}\PY{n}{intercept\PYZus{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p values is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pvalues}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The test score is}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         \PY{n}{dram\PYZus{}diagram}\PY{p}{(}\PY{n}{l}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(69, 73)
number of features selected is 70
best score is  0.9714285714285715
70 0.9714285714285715
[[7.44760624e-07 9.99999255e-01]
 [2.79879908e-06 9.99997201e-01]
 [1.39466596e-05 9.99986053e-01]
 [1.67392865e-02 9.83260714e-01]
 [3.76231412e-02 9.62376859e-01]
 [1.49449668e-03 9.98505503e-01]
 [4.56539797e-03 9.95434602e-01]
 [1.18298578e-02 9.88170142e-01]
 [3.28001482e-03 9.96719985e-01]
 [9.99968354e-01 3.16462400e-05]
 [9.99980173e-01 1.98274548e-05]
 [9.99966565e-01 3.34347282e-05]
 [9.99989151e-01 1.08494545e-05]
 [9.99948159e-01 5.18409100e-05]
 [9.99935660e-01 6.43396284e-05]
 [9.99831138e-01 1.68861679e-04]
 [9.99763066e-01 2.36933676e-04]
 [9.99934161e-01 6.58394335e-05]
 [9.99714372e-01 2.85628057e-04]
 [9.95991266e-01 4.00873447e-03]
 [9.98749234e-01 1.25076631e-03]
 [9.99999998e-01 2.32438010e-09]
 [9.99999967e-01 3.30587647e-08]
 [9.99982535e-01 1.74649941e-05]
 [9.99985649e-01 1.43512550e-05]
 [9.90069008e-01 9.93099217e-03]
 [9.99999051e-01 9.48748831e-07]
 [9.98542429e-01 1.45757105e-03]
 [1.00000000e+00 3.77122191e-10]
 [9.99999967e-01 3.30587647e-08]
 [9.99985649e-01 1.43512550e-05]
 [9.99999051e-01 9.48748831e-07]
 [9.98541858e-01 1.45814161e-03]
 [9.98198578e-01 1.80142242e-03]
 [9.87493719e-01 1.25062809e-02]
 [9.68184966e-01 3.18150338e-02]
 [9.93508021e-01 6.49197861e-03]
 [9.97734878e-01 2.26512242e-03]
 [9.99357343e-01 6.42656743e-04]
 [9.98432927e-01 1.56707349e-03]
 [9.99581237e-01 4.18762637e-04]
 [9.99982484e-01 1.75156594e-05]
 [9.97271075e-01 2.72892519e-03]
 [9.99745344e-01 2.54655595e-04]
 [9.98000879e-01 1.99912138e-03]
 [9.99998874e-01 1.12601813e-06]
 [9.99985079e-01 1.49206073e-05]
 [9.99996817e-01 3.18266873e-06]
 [9.99999732e-01 2.68162227e-07]
 [9.99996222e-01 3.77780270e-06]
 [9.99999560e-01 4.40016843e-07]
 [9.99983656e-01 1.63444351e-05]
 [9.99966816e-01 3.31843254e-05]
 [9.99618797e-01 3.81202908e-04]
 [9.99924371e-01 7.56290328e-05]
 [9.97414859e-01 2.58514060e-03]
 [9.99953844e-01 4.61556838e-05]
 [9.99988958e-01 1.10420554e-05]
 [9.99925231e-01 7.47690449e-05]
 [9.99970563e-01 2.94373927e-05]
 [9.99977937e-01 2.20630272e-05]
 [9.99969140e-01 3.08600105e-05]
 [9.99976644e-01 2.33556504e-05]
 [9.99986529e-01 1.34714151e-05]
 [9.99857895e-01 1.42105239e-04]
 [9.99984412e-01 1.55876916e-05]
 [9.99961808e-01 3.81916605e-05]
 [9.99974562e-01 2.54379071e-05]
 [9.99983918e-01 1.60824221e-05]]
confusion matrix for train [[60  0]
 [ 0  9]]
confusion matrix for test [[15  0]
 [ 0  4]]
coefficient is  [[-9.06346564e-02 -1.18833175e-01 -2.01884851e-02  1.84768254e-02
  -1.48130124e-01  2.44892836e-02 -2.06616438e-01 -9.66633852e-02
  -8.66684197e-02 -1.13604829e-02  4.39995684e-02  3.64335222e-02
  -1.13248808e-02 -1.58957377e-01 -1.96734144e-02 -1.52222606e-02
  -7.35988436e-02 -1.22102885e-02 -4.05682156e-02 -6.84654808e-02
  -1.89427256e-02 -1.84604205e-02 -3.01037970e-02 -1.55132665e-02
  -1.56363649e-01  1.52976519e-01  1.07165209e-01 -7.72903648e-02
   1.64137958e-02  4.47754740e-04  1.15175963e-01 -4.22134500e-02
  -5.65816746e-02 -7.93222355e-02 -8.40224767e-03 -3.88357616e-02
   2.01173656e-04  1.51726104e-01  1.79834599e-02 -1.93332336e-02
  -1.44953338e-01 -1.76874781e-02 -3.31182803e-02 -5.97028143e-02
  -1.29265140e-02 -2.11796536e-02  1.28886335e-02 -4.45563178e-03
   2.52629274e-01  4.11818520e-01  9.72554631e-02  9.94568000e-02
   1.03972940e-01 -3.89655828e-02  6.60078302e-02 -8.25034148e-03
  -1.06155331e-01  1.95055098e-01  1.02749004e-01 -7.30074111e-02
  -2.31112630e-02 -1.15541129e-02 -3.67363624e-03 -3.57953247e-02
  -1.54573753e-01 -2.55182341e-02 -2.89288000e-02 -1.52694298e-01
  -2.33634365e-02 -3.17110798e-02 -1.04792557e-01 -1.70852698e-02]]
interception is  [-0.0095948]
p values is  [5.29861542e-01 3.68305945e-01 3.90809400e-01 7.91639315e-01
 6.35189925e-01 3.00640363e-01 2.61624700e-01 2.09274058e-01
 2.11266284e-01 5.59859763e-01 2.72615917e-01 3.36876736e-01
 6.17960561e-03 1.75989568e-04 7.10204612e-02 6.50807497e-03
 2.77992618e-03 1.41864675e-01 4.61191214e-03 1.19123025e-05
 6.18599357e-02 5.80969269e-03 1.48828054e-05 6.13160620e-02
 5.62134182e-02 9.60767045e-03 8.52216215e-02 3.39298288e-02
 3.40277344e-03 5.60385720e-02 2.48477006e-02 9.52650251e-02
 7.80065167e-01 2.56792740e-01 7.41927166e-02 6.99771336e-01
 6.63097219e-02 6.76822845e-01 6.50277663e-01 7.41023405e-02
 2.55285512e-01 5.82781838e-01 3.74342641e-02 8.04863962e-02
 3.84282042e-01 3.64780131e-02 1.89465164e-01 4.14344112e-01
 1.10673780e-17 1.14303593e-14 5.49848144e-01 4.31583655e-11
 7.32698490e-09 8.29526845e-01 1.23117987e-08 7.51308970e-05
 2.73720348e-01 1.92780635e-09 1.42105778e-05 3.48598320e-01
 3.40417259e-02 2.36545870e-01 4.22990692e-01 4.03173174e-02
 6.41128112e-03 2.99411830e-01 2.27024413e-02 6.59279327e-04
 1.88694179e-01 1.32986085e-02 5.02792857e-04 1.19897416e-01]
The test score is 1.0

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    d\_v: for the cross validation accuracy, the score is
0.9714285714285715, and the test score is 1.0

    d\_vi: That is true, my class have some kind of well-separated problem
which causes instability. However, I can use some penalty to penalize
them and I can have a good result.

    d\_vii: There is no imbalanced classes, since the definition of
imbalanced classes is that ratio of one number of one class to the other
classes is going to zero. But in this question, the lowest ratio is 0.2,
not zero.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{k}{def} \PY{n+nf}{e\PYZus{}1}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{C\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{train\PYZus{}score\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{test\PYZus{}score\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{whole\PYZus{}data} \PY{o}{=} \PY{n}{create\PYZus{}samples}\PY{p}{(}\PY{n}{path}\PY{p}{)}
             \PY{n}{l\PYZus{}1} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{k}{for} \PY{n}{l} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                 \PY{n}{train} \PY{o}{=} \PY{n}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{l}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}
                 \PY{n}{train\PYZus{}2} \PY{o}{=} \PY{p}{(}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{values}
                 \PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{train\PYZus{}2}\PY{p}{,} \PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}2}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}
         
                 \PY{n}{test} \PY{o}{=} \PY{n}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{l}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{test\PYZus{}2} \PY{o}{=} \PY{p}{(}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{values}
                 \PY{n}{x\PYZus{}test} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{test\PYZus{}2}\PY{p}{,} \PY{n}{test\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test\PYZus{}2}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{test\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         
                 \PY{n}{train\PYZus{}set\PYZus{}x} \PY{o}{=} \PY{n}{normalize}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{test\PYZus{}set\PYZus{}x} \PY{o}{=} \PY{n}{normalize}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{cv} \PY{o}{=} \PY{n}{StratifiedKFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}  \PY{c+c1}{\PYZsh{} stratified method, 5 folds}
                 \PY{n}{classifier\PYZus{}new} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{solver}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{liblinear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{cv}\PY{p}{)}
                 \PY{n}{classifier\PYZus{}new}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}set\PYZus{}x}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
                 \PY{n}{train\PYZus{}set\PYZus{}predic} \PY{o}{=} \PY{n}{classifier\PYZus{}new}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{train\PYZus{}set\PYZus{}x}\PY{p}{)}
                 \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{classifier\PYZus{}new}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{train\PYZus{}set\PYZus{}x}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
                 \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{classifier\PYZus{}new}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{test\PYZus{}set\PYZus{}x}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
                 \PY{n}{C} \PY{o}{=} \PY{n}{classifier\PYZus{}new}\PY{o}{.}\PY{n}{C\PYZus{}}
                 \PY{n}{C\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{C}\PY{p}{)}
                 \PY{n}{train\PYZus{}score\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{train\PYZus{}score}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{train\PYZus{}score}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{test\PYZus{}score}\PY{p}{)}
                 \PY{n}{test\PYZus{}score\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{test\PYZus{}score}\PY{p}{)}
         
             \PY{n}{num} \PY{o}{=} \PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{test\PYZus{}score\PYZus{}1}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The best C is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{C\PYZus{}1}\PY{p}{[}\PY{n}{num}\PY{p}{]}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The bset test accuracy is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{test\PYZus{}score\PYZus{}1}\PY{p}{[}\PY{n}{num}\PY{p}{]}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The best l is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{l\PYZus{}1}\PY{p}{[}\PY{n}{num}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{e\PYZus{}1}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(69, 19)
0.9855072463768116
1.0
(69, 37)
1.0
0.9473684210526315
(69, 55)
1.0
0.9473684210526315
(69, 73)
0.9855072463768116
0.9473684210526315
(69, 91)
1.0
0.9473684210526315
(69, 109)
1.0
0.9473684210526315
(69, 127)
1.0
0.9473684210526315
(69, 145)
1.0
1.0
(69, 163)
1.0
0.9473684210526315
(69, 181)
1.0
1.0
(69, 199)
1.0
0.9473684210526315
(69, 217)
1.0
0.9473684210526315
(69, 235)
0.9855072463768116
0.9473684210526315
(69, 253)
0.9855072463768116
0.9473684210526315
(69, 271)
1.0
0.9473684210526315
(69, 289)
1.0
0.9473684210526315
(69, 307)
1.0
0.9473684210526315
(69, 325)
0.9855072463768116
0.9473684210526315
(69, 343)
0.9855072463768116
0.9473684210526315
(69, 361)
1.0
1.0
The best C is  [21.5443469]
The bset test accuracy is  1.0
The best l is  1

    \end{Verbatim}

    e\_ii: The method in L1 penalized logistic regresstion is better, since
it is very quick to see the results, and the test score is up to 1, it
is very high actually.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{k}{def} \PY{n+nf}{f\PYZus{}1}\PY{p}{(}\PY{n}{classifier\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LogisticRegression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{C\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{train\PYZus{}score\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{test\PYZus{}score\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{test\PYZus{}sample} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{train\PYZus{}sample} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{l\PYZus{}1} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{whole\PYZus{}data}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{create\PYZus{}samples\PYZus{}multi}\PY{p}{(}\PY{n}{path}\PY{p}{)}
             \PY{n}{activity} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bending1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bending2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cycling}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lying}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sitting}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{standing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{walking}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{k}{for} \PY{n}{l} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                 \PY{n}{train} \PY{o}{=} \PY{n}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{l}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}
                 \PY{n}{train\PYZus{}2} \PY{o}{=} \PY{p}{(}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{values}
                 \PY{n}{x\PYZus{}train\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{train\PYZus{}2}\PY{p}{,} \PY{n}{train\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
                 \PY{n}{test} \PY{o}{=} \PY{n}{d\PYZus{}3\PYZus{}1}\PY{p}{(}\PY{n}{test\PYZus{}data}\PY{p}{,} \PY{n}{l}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{test\PYZus{}2} \PY{o}{=} \PY{p}{(}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{values}
                 \PY{n}{x\PYZus{}test\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{test\PYZus{}2}\PY{p}{,} \PY{n}{test\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{cv} \PY{o}{=} \PY{n}{StratifiedKFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}  \PY{c+c1}{\PYZsh{} stratified method, 5 folds}
                 \PY{n}{test\PYZus{}sample}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{)}
                 \PY{n}{train\PYZus{}sample}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}1}\PY{p}{)}
         
                 \PY{k}{if} \PY{n}{classifier\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LogisticRegression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                     \PY{n}{classifier} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{solver}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{liblinear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{multi\PYZus{}class}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ovr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{cv}\PY{p}{)}
                     \PY{n}{x\PYZus{}train\PYZus{}1} \PY{o}{=} \PY{n}{normalize}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}1}\PY{p}{)}
                     \PY{n}{x\PYZus{}test\PYZus{}1} \PY{o}{=} \PY{n}{normalize}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{)}
                 \PY{k}{elif} \PY{n}{classifier\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GaussianNB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                     \PY{n}{classifier} \PY{o}{=} \PY{n}{GaussianNB}\PY{p}{(}\PY{p}{)}
                 \PY{k}{elif} \PY{n}{classifier\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MultinomialNB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                     \PY{n}{classifier} \PY{o}{=} \PY{n}{MultinomialNB}\PY{p}{(}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{k}{pass}
         
                 \PY{n}{classifier}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}1}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
                 \PY{n}{train\PYZus{}set\PYZus{}predic} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}1}\PY{p}{)}
                 \PY{n}{test\PYZus{}set\PYZus{}predic} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{)}
                 \PY{n}{vc\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{test\PYZus{}set\PYZus{}predic}\PY{p}{)}
                 \PY{n}{vc\PYZus{}matrix\PYZus{}train} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{test\PYZus{}set\PYZus{}predic}\PY{p}{)}
         
                 \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
         
                 \PY{n}{test\PYZus{}error} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{classifier}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test error = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{test\PYZus{}error}\PY{p}{)}\PY{p}{)}
                 \PY{n}{test\PYZus{}score\PYZus{}1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{test\PYZus{}error}\PY{p}{)}
         
         
             \PY{n}{Num} \PY{o}{=} \PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{test\PYZus{}score\PYZus{}1}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
             \PY{n}{xdata} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}
             \PY{n}{ydata} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}
             \PY{n}{x\PYZus{}train\PYZus{}1} \PY{o}{=} \PY{n}{train\PYZus{}sample}\PY{p}{[}\PY{n}{Num}\PY{p}{]}
             \PY{n}{x\PYZus{}test\PYZus{}1} \PY{o}{=} \PY{n}{test\PYZus{}sample}\PY{p}{[}\PY{n}{Num}\PY{p}{]}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The lowest test error is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{test\PYZus{}score\PYZus{}1}\PY{p}{[}\PY{n}{Num}\PY{p}{]}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The best l is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{l\PYZus{}1}\PY{p}{[}\PY{n}{Num}\PY{p}{]}\PY{p}{)}
         
             \PY{k}{if} \PY{n}{classifier\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LogisticRegression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{classifier} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{solver}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{liblinear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{multi\PYZus{}class}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ovr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{cv}\PY{p}{)}
                 \PY{n}{x\PYZus{}train\PYZus{}1} \PY{o}{=} \PY{n}{normalize}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}1}\PY{p}{)}
                 \PY{n}{x\PYZus{}test\PYZus{}1} \PY{o}{=} \PY{n}{normalize}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{)}
             \PY{k}{elif} \PY{n}{classifier\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GaussianNB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{classifier} \PY{o}{=} \PY{n}{GaussianNB}\PY{p}{(}\PY{p}{)}
             \PY{k}{elif} \PY{n}{classifier\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MultinomialNB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{classifier} \PY{o}{=} \PY{n}{MultinomialNB}\PY{p}{(}\PY{p}{)}
             \PY{k}{else}\PY{p}{:}
                 \PY{k}{pass}
             \PY{n}{classifier}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}1}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{)}
             \PY{n}{train\PYZus{}set\PYZus{}predic} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{x\PYZus{}train\PYZus{}1}\PY{p}{)}
         
             \PY{n}{test\PYZus{}set\PYZus{}predic} \PY{o}{=} \PY{n}{classifier}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{x\PYZus{}test\PYZus{}1}\PY{p}{)}
             \PY{n}{vc\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}train} \PY{p}{,} \PY{n}{train\PYZus{}set\PYZus{}predic}\PY{p}{)}
             \PY{n}{vc\PYZus{}matrix\PYZus{}train} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{test\PYZus{}set\PYZus{}predic}\PY{p}{)}
             
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Following is the confusion matrix of test: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{vc\PYZus{}matrix\PYZus{}test}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Following is the confusion matrix of train: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{vc\PYZus{}matrix\PYZus{}train}\PY{p}{)}
         
             \PY{n}{auc\PYZus{}var} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}
             \PY{n}{test\PYZus{}set\PYZus{}y} \PY{o}{=} \PY{n}{label\PYZus{}binarize}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{activity}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{:}
                 \PY{n}{res} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{test\PYZus{}set\PYZus{}y}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{test\PYZus{}score}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n}{xdata}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{res}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                 \PY{n}{ydata}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{res}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                 \PY{n}{auc\PYZus{}var}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{auc}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{res}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{res}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{activity}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AUC = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{auc\PYZus{}var}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lower right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FPR}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TPR}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{f\PYZus{}1}\PY{p}{(}\PY{n}{classifier\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LogisticRegression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
D:\textbackslash{}G\textbackslash{}Anaconda3\_python3.6\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}model\_selection\textbackslash{}\_split.py:605: Warning: The least populated class in y has only 4 members, which is too few. The minimum number of members in any class cannot be less than n\_splits=5.
  \% (min\_groups, self.n\_splits)), Warning)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test error = 0.368421052631579
Test error = 0.368421052631579
Test error = 0.3157894736842105
Test error = 0.21052631578947367
Test error = 0.368421052631579
Test error = 0.26315789473684215
Test error = 0.3157894736842105
Test error = 0.1578947368421053
Test error = 0.26315789473684215
Test error = 0.3157894736842105
Test error = 0.3157894736842105
Test error = 0.3157894736842105
Test error = 0.368421052631579
Test error = 0.368421052631579
Test error = 0.3157894736842105
Test error = 0.5263157894736843
Test error = 0.4736842105263158
Test error = 0.368421052631579
Test error = 0.42105263157894735
Test error = 0.42105263157894735
The lowest test error is  0.1578947368421053
The best l is  8
Following is the confusion matrix of test: 
[[ 5  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0]
 [ 0  0 12  0  0  0  0]
 [ 0  0  0 12  0  0  0]
 [ 0  0  0  0 12  0  0]
 [ 0  0  0  0  0 12  0]
 [ 0  0  0  0  0  0 12]]
Following is the confusion matrix of train: 
[[2 0 0 0 0 0 0]
 [1 0 1 0 0 0 0]
 [0 0 3 0 0 0 0]
 [0 0 0 3 0 0 0]
 [0 0 0 0 3 0 0]
 [0 0 0 1 0 2 0]
 [0 0 0 0 0 0 3]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{f\PYZus{}1}\PY{p}{(}\PY{n}{classifier\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GaussianNB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Test error = 0.10526315789473684
Test error = 0.052631578947368474
Test error = 0.10526315789473684
Test error = 0.10526315789473684
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.21052631578947367
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.21052631578947367
Test error = 0.26315789473684215
Test error = 0.3157894736842105
Test error = 0.1578947368421053
Test error = 0.26315789473684215
Test error = 0.21052631578947367
Test error = 0.21052631578947367
Test error = 0.26315789473684215
Test error = 0.21052631578947367
Test error = 0.26315789473684215
The lowest test error is  0.052631578947368474
The best l is  2
Following is the confusion matrix of test: 
[[ 5  0  0  0  0  0  0]
 [ 0  3  0  1  0  0  0]
 [ 0  0 12  0  0  0  0]
 [ 0  0  0 12  0  0  0]
 [ 0  0  0  0 12  0  0]
 [ 0  0  0  0  0 12  0]
 [ 0  0  0  0  0  0 12]]
Following is the confusion matrix of train: 
[[2 0 0 0 0 0 0]
 [0 2 0 0 0 0 0]
 [0 0 3 0 0 0 0]
 [0 0 0 3 0 0 0]
 [0 0 0 0 3 0 0]
 [0 0 0 0 1 2 0]
 [0 0 0 0 0 0 3]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{f\PYZus{}1}\PY{p}{(}\PY{n}{classifier\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MultinomialNB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Test error = 0.10526315789473684
Test error = 0.21052631578947367
Test error = 0.21052631578947367
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.21052631578947367
Test error = 0.21052631578947367
Test error = 0.052631578947368474
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.21052631578947367
Test error = 0.1578947368421053
Test error = 0.1578947368421053
Test error = 0.10526315789473684
Test error = 0.10526315789473684
Test error = 0.10526315789473684
Test error = 0.10526315789473684
The lowest test error is  0.052631578947368474
The best l is  11
Following is the confusion matrix of test: 
[[ 5  0  0  0  0  0  0]
 [ 1  3  0  0  0  0  0]
 [ 0  0 12  0  0  0  0]
 [ 0  0  0 12  0  0  0]
 [ 0  0  0  0 12  0  0]
 [ 0  0  0  0  1 11  0]
 [ 0  0  0  0  0  0 12]]
Following is the confusion matrix of train: 
[[2 0 0 0 0 0 0]
 [0 2 0 0 0 0 0]
 [0 0 3 0 0 0 0]
 [0 0 0 3 0 0 0]
 [0 0 0 0 2 1 0]
 [0 0 0 0 0 3 0]
 [0 0 0 0 0 0 3]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    f\_iii: The best two is Multinomial priors and Gaussian, since its test
error is same.


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
